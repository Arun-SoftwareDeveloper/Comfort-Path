<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>COMFORT_PATH</title>
    <link rel="icon" href="./Images/title-logo.png" />
    <!-- Include Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="../Css/style.css" />
  </head>
  <body>
    <!-- Main content container -->
    <div class="container mt-4">
      <h1>Welcome to Comfort Path</h1>
      <p>
        Explore our wide range of products and enjoy a comfortable shopping
        experience.
      </p>

      <!-- Search bar -->
      <div class="input-group mb-3">
        <input
          type="text"
          class="form-control"
          id="searchInput"
          placeholder="Search something..."
          aria-label="Search something..."
          aria-describedby="basic-addon2"
        />
        <div class="input-group-append">
          <button class="btn btn-primary" type="button" id="searchButton">
            <i class="fas fa-search"></i> Search
          </button>
        </div>
      </div>
      <div class="row">
        <!-- Add your product listings here -->
      </div>
      <!-- Razorpay Payment Button -->
      <button id="payButton" class="btn btn-success">Pay with Razorpay</button>
    </div>

    <!-- Include Bootstrap JS and jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- Include Razorpay Script -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const payButton = document.getElementById("payButton");

        payButton.addEventListener("click", function () {
          // Example: Simulating a successful payment
          const orderData = {
            amount: 1000, // Replace with the actual amount in paisa (e.g., 1000 for 10 INR)
          };

          // Replace 'your_api_key' with your actual Razorpay API key

          // Create a new order on your backend and get the order ID
          fetch("https://comfort-path.onrender.com/payment/create-order", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(orderData),
          })
            .then((response) => response.json())
            .then((orderData) => {
              if (orderData.id) {
                const options = {
                  amount: orderData.amount,
                  currency: "INR",
                  name: "Your Company Name",
                  description: "Payment for Order",
                  order_id: orderData.id,
                  handler: function (response) {
                    // Handle the payment success on your backend
                    fetch("https://comfort-path.onrender.com/payment/success", {
                      method: "POST",
                      headers: {
                        "Content-Type": "application/json",
                      },
                      body: JSON.stringify(response),
                    })
                      .then((response) => response.json())
                      .then((data) => {
                        if (data.success) {
                          alert(
                            "Payment successful. An email confirmation has been sent."
                          );
                        } else {
                          alert("Payment processing failed");
                        }
                      });
                  },
                };

                const rzp = new Razorpay(options);
                rzp.open();
              } else {
                alert("Failed to create the payment order");
              }
            });
        });
      });
    </script>
  </body>
</html>
